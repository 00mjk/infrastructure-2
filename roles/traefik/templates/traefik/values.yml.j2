# traefik/traefik
# https://github.com/traefik/traefik-helm-chart/blob/master/traefik/values.yaml
# k3s specifics
image:
  name: traefik

ingressRoute:
  dashboard:
    enabled: false

# traefik specifics
globalArguments:
  - --global.checknewversion=false
  - --global.sendanonymoususage=false

additionalArguments:
  # misc
  - '--providers.kubernetescrd.allowCrossNamespace=true'
  - '--serverstransport.insecureskipverify'
  - '--ping.entrypoint=traefik'

ports:
  # services
  http:
    port: 9080
    expose: true
    exposedPort: 80
    redirectTo: https
  https:
    port: 9443
    expose: true
    exposedPort: 443

  # metrics
  traefik:
    port: 9000
    expose: false
    exposedPort: 9000

  # disable default entry points
  web: null
  websecure: null
  metrics: null

service:
  spec:
    externalTrafficPolicy: Local

env:
  - name: TZ
    value: '{{ timezone }}'

logs:
  access:
    enabled: true
    filters:
      statuscodes: 400-599

metrics:
  prometheus:
    entryPoint: traefik
